# Updated Excel Structure - ALL Rules in CSV

## This is what your Excel file now looks like:

Row 1:  RuleSet | com.bank.migration.rules |  |  |  |  |  |  |  |  |
Row 2:  Sequential | false |  |  |  |  |  |  |  |  |
Row 3:  Import | com.bank.migration.model.rules.CustomerMigrationContext |  |  |  |  |  |  |  |  |
Row 4:  Import | com.bank.migration.model.migration.MigrationWave |  |  |  |  |  |  |  |  |
Row 5:  (EMPTY ROW)
Row 6:  RuleTable Migration Feature Rules |  |  |  |  |  |  |  |  |  |
Row 7:  NAME | CONDITION | CONDITION | CONDITION | CONDITION | CONDITION | CONDITION | ACTION | ACTION | ACTION | ACTION
Row 8:  Rule Name | hasNotMigratedStatus() | allAccountsInTerminalState() | currentWave | hasSavingsOrCD() | hasChecking() | hasLendingOrIRA() | feature1 | feature2 | feature3 | feature4
Row 9:  (empty) | $context : CustomerMigrationContext | $context | $context | $context | $context | $context | $context | $context | $context | $context

--- RULES START BELOW (Rows 10+) ---

Row 10: Priority 1 - Dropped Customer | true | (blank) | (blank) | (blank) | (blank) | (blank) | enabled | enabled | enabled | enabled
Row 11: Priority 2 - Terminal States | false | true | (blank) | (blank) | (blank) | (blank) | enabled | enabled | enabled | enabled
Row 12: WAVE1 - Suppress Savings/CD only | false | false | WAVE1 | true | false | false | disabled | disabled | disabled | disabled
Row 13: WAVE1 - Enable Savings/CD with Checking | false | false | WAVE1 | true | true | (blank) | enabled | enabled | enabled | enabled
Row 14: WAVE1 - Suppress Savings/CD with Lending/IRA | false | false | WAVE1 | true | (blank) | true | disabled | disabled | disabled | disabled
Row 15: WAVE2 - Suppress Savings/CD/Checking | false | false | WAVE2 | true | true | false | disabled | disabled | disabled | disabled
Row 16: WAVE2 - Suppress with Lending/IRA | false | false | WAVE2 | true | true | true | disabled | disabled | disabled | disabled
Row 17: Default - Not in scope | false | false | NOT_APPLICABLE | (blank) | (blank) | (blank) | enabled | enabled | enabled | enabled
Row 18: Default - No Savings or CD | false | false | (blank) | false | (blank) | (blank) | enabled | enabled | enabled | enabled

## New Columns Explained

### Column B: hasNotMigratedStatus()
- true = ANY account has NOT_MIGRATED status
- false = No NOT_MIGRATED accounts
- blank = Don't check

### Column C: allAccountsInTerminalState()
- true = ALL accounts are MIGRATED/EXCLUDED/NOT_MIGRATED
- false = Has SCHEDULED or IN_PROGRESS accounts
- blank = Don't check

### Columns D-G: Same as before
- D: currentWave
- E: hasSavingsOrCD()
- F: hasChecking()
- G: hasLendingOrIRA()

### Columns H-K: Same as before
- H: feature1
- I: feature2
- J: feature3
- K: feature4

## Rule Priority (Top to Bottom)

1. **Row 10** checks for dropped customers FIRST
2. **Row 11** checks for terminal states SECOND
3. **Rows 12-16** handle active migrations THIRD
4. **Rows 17-18** are default catch-alls

## How Rules Fire

**Example 1: Dropped Customer**
- Row 10 matches (hasNotMigratedStatus = true)
- All features enabled
- Rows 11-18 never checked (first match wins)

**Example 2: All Accounts Migrated**
- Row 10 doesn't match (hasNotMigratedStatus = false)
- Row 11 matches (allAccountsInTerminalState = true)
- All features enabled
- Rows 12-18 never checked

**Example 3: WAVE1 Active Migration**
- Row 10 doesn't match (false)
- Row 11 doesn't match (false)
- Row 12 matches (WAVE1 conditions)
- Features controlled per row 12

## To Modify Rules

### Change Priority 1 Behavior
Edit Row 10, Column H-K (feature columns)

### Change Priority 2 Behavior
Edit Row 11, Column H-K (feature columns)

### Change WAVE1/WAVE2 Rules
Edit Rows 12-16 as before

### Add New Priority Rule
Insert row between 11 and 12

## Benefits

✅ Everything visible in Excel
✅ Business can modify all logic
✅ No Java code changes needed
✅ Complete transparency
✅ Easy to audit changes

